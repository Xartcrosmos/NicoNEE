<!DOCTYPE html>
<html>
<head>
  <title>Bike Rack Registration</title>
  <style>
    body { font-family: Arial; margin: 30px; }
    input, button { padding: 10px; margin: 5px 0; }
  </style>
</head>
<body>
  <h2>Register Your Device</h2>
  <form id="regForm">
    <input type="text" id="name" placeholder="Your Name" required><br>
    <input type="text" id="contact" placeholder="Contact Number" required><br>
    <button type="submit">Submit</button>
  </form>
  <p id="statusMsg"></p>

  <script>
    const supabaseUrl = "https://qkswuqrgtbfcdywzuxtk.supabase.co/rest/v1/registrations";
    const supabaseKey = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InFrc3d1cXJndGJmY2R5d3p1eHRrIiwicm9sZSI6ImFub24iLCJpYXQiOjE3Njc3MjU4MTIsImV4cCI6MjA4MzMwMTgxMn0.OHKaVlA9IpHwlEq5cCm6crJ-n-P-M762MvZqB0XiZxYY";

    document.getElementById('regForm').addEventListener('submit', async (e) => {
      e.preventDefault();
      const name = document.getElementById('name').value;
      const contact = document.getElementById('contact').value;

      const body = {
        name: name,
        contact: contact,
        status: "pending"
      };

      const res = await fetch(supabaseUrl, {
        method: 'POST',
        headers: {
          "apikey": supabaseKey,
          "Authorization": "Bearer " + supabaseKey,
          "Content-Type": "application/json"
        },
        body: JSON.stringify(body)
      });

      if(res.ok) {
        document.getElementById('statusMsg').innerText = "Registration submitted! Place your finger on the device.";
      } else {
        document.getElementById('statusMsg').innerText = "Error submitting. Try again.";
      }
    });
  </script>
</body>
</html>
