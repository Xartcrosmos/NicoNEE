<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>ESP32 Registration</title>
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2.33.0/dist/supabase.min.js"></script>
</head>
<body>
  <h3>Register User</h3>
  <input id="name" placeholder="Name">
  <input id="contact" placeholder="Number">
  <button onclick="register()">Send</button>

  <script>
    // Supabase connection
    const supabaseUrl = 'https://qkswuqrgtbfcdywzuxtk.supabase.co';
    const supabaseKey = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InFrc3d1cXJndGJmY2R5d3p1eHRrIiwicm9sZSI6ImFub24iLCJpYXQiOjE3Njc3MjU4MTIsImV4cCI6MjA4MzMwMTgxMn0.OHKaVlA9IpHwlEq5cCm6crJ-n-P-M762MvZqB0XiZxY';
    const supabase = Supabase.createClient(supabaseUrl, supabaseKey);

    async function register() {
      const name = document.getElementById("name").value;
      const contact = document.getElementById("contact").value;

      if (!name || !contact) {
        alert("Fill both fields!");
        return;
      }

      const { data, error } = await supabase
        .from('registrations')
        .insert([
          { name: name, contact: contact, status: 'pending', device: '', fingerID: null }
        ]);

      if (error) {
        console.error(error);
        alert("Failed to register");
      } else {
        alert("Registration sent!");
        console.log(data);
      }
    }
  </script>
</body>
</html>
